#------------------------------------------------------------------------
# Source File Information (DO NOT MODIFY)
# Source ID: 98661fbb-e8c1-4665-94f8-eccb3d62621c
# Source File: Main.psf
#------------------------------------------------------------------------
#region File Recovery Data (DO NOT MODIFY)
<#RecoveryData:
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#>
#endregion

<#
    .NOTES
    --------------------------------------------------------------------------------
     Code generated by:  SAPIEN Technologies, Inc., PowerShell Studio 2017 v5.4.134
     Generated on:       7/31/2018 3:26 AM
     Generated by:       Administrator
    --------------------------------------------------------------------------------
    .DESCRIPTION
        GUI script generated by PowerShell Studio 2017
#>


#----------------------------------------------
#region Application Functions
#----------------------------------------------

#endregion Application Functions

#----------------------------------------------
# Generated Form Function
#----------------------------------------------
function Show-Main_psf {

	#----------------------------------------------
	#region Import the Assemblies
	#----------------------------------------------
	[void][reflection.assembly]::Load('System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089')
	[void][reflection.assembly]::Load('System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089')
	[void][reflection.assembly]::Load('System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a')
	#endregion Import Assemblies

	#----------------------------------------------
	#region Generated Form Objects
	#----------------------------------------------
	[System.Windows.Forms.Application]::EnableVisualStyles()
	$formLazyAdmin = New-Object 'System.Windows.Forms.Form'
	$Labelcount2 = New-Object 'System.Windows.Forms.Label'
	$UsersinthisGroup = New-Object 'System.Windows.Forms.Button'
	$groupbox5 = New-Object 'System.Windows.Forms.GroupBox'
	$button1 = New-Object 'System.Windows.Forms.Button'
	$radiobutton6 = New-Object 'System.Windows.Forms.RadioButton'
	$labelCount = New-Object 'System.Windows.Forms.Label'
	$buttonNotePad = New-Object 'System.Windows.Forms.Button'
	$groupbox4 = New-Object 'System.Windows.Forms.GroupBox'
	$buttonDCEventLog = New-Object 'System.Windows.Forms.Button'
	$radiobuttonNewestEntries = New-Object 'System.Windows.Forms.RadioButton'
	$datetimepicker1 = New-Object 'System.Windows.Forms.DateTimePicker'
	$numericupdown1 = New-Object 'System.Windows.Forms.NumericUpDown'
	$buttonPCEventLog = New-Object 'System.Windows.Forms.Button'
	$labelWindowsAndPowershell = New-Object 'System.Windows.Forms.Label'
	$buttonAddAPrinter = New-Object 'System.Windows.Forms.Button'
	$buttonDisplayAttachedPrint = New-Object 'System.Windows.Forms.Button'
	$labelResult = New-Object 'System.Windows.Forms.Label'
	$buttonShutDownRestart = New-Object 'System.Windows.Forms.Button'
	$buttonPingIt = New-Object 'System.Windows.Forms.Button'
	$textbox5 = New-Object 'System.Windows.Forms.TextBox'
	$buttonTerminateARunningPro = New-Object 'System.Windows.Forms.Button'
	$textbox4 = New-Object 'System.Windows.Forms.TextBox'
	$buttonSendAMessage = New-Object 'System.Windows.Forms.Button'
	$buttonAbout = New-Object 'System.Windows.Forms.Button'
	$groupbox3 = New-Object 'System.Windows.Forms.GroupBox'
	$buttonGenerateUserNTFSRepo = New-Object 'System.Windows.Forms.Button'
	$textbox6 = New-Object 'System.Windows.Forms.TextBox'
	$buttonSaveReportTo = New-Object 'System.Windows.Forms.Button'
	$buttonGenerateFolderNTFSRe = New-Object 'System.Windows.Forms.Button'
	$textbox3 = New-Object 'System.Windows.Forms.TextBox'
	$labelWriteOrBrowsTheRootF = New-Object 'System.Windows.Forms.Label'
	$buttonSelectFolder = New-Object 'System.Windows.Forms.Button'
	$DGV = New-Object 'System.Windows.Forms.DataGridView'
	$groupbox2 = New-Object 'System.Windows.Forms.GroupBox'
	$radiobutton2 = New-Object 'System.Windows.Forms.RadioButton'
	$numericupdown3 = New-Object 'System.Windows.Forms.NumericUpDown'
	$radiobuttonNameEndWith = New-Object 'System.Windows.Forms.RadioButton'
	$radiobuttonNameInclude = New-Object 'System.Windows.Forms.RadioButton'
	$radiobuttonDescriptionIncludeAW = New-Object 'System.Windows.Forms.RadioButton'
	$radiobuttonNameBeginWith = New-Object 'System.Windows.Forms.RadioButton'
	$radiobutton1 = New-Object 'System.Windows.Forms.RadioButton'
	$textbox1 = New-Object 'System.Windows.Forms.TextBox'
	$buttonComputers = New-Object 'System.Windows.Forms.Button'
	$DGV2 = New-Object 'System.Windows.Forms.DataGridView'
	$textbox2 = New-Object 'System.Windows.Forms.TextBox'
	$groupbox1 = New-Object 'System.Windows.Forms.GroupBox'
	$radiobuttonEnabled = New-Object 'System.Windows.Forms.RadioButton'
	$radiobutton5 = New-Object 'System.Windows.Forms.RadioButton'
	$radiobutton4 = New-Object 'System.Windows.Forms.RadioButton'
	$radiobutton3 = New-Object 'System.Windows.Forms.RadioButton'
	$numericupdown2 = New-Object 'System.Windows.Forms.NumericUpDown'
	$radiobuttonInactiveForTheLastDa = New-Object 'System.Windows.Forms.RadioButton'
	$radiobuttonPasswordNeverExpire = New-Object 'System.Windows.Forms.RadioButton'
	$radiobuttonPasswordExpired = New-Object 'System.Windows.Forms.RadioButton'
	$buttonShow = New-Object 'System.Windows.Forms.Button'
	$radiobuttonAll = New-Object 'System.Windows.Forms.RadioButton'
	$radiobuttonDisabled = New-Object 'System.Windows.Forms.RadioButton'
	$radiobuttonLockedOut = New-Object 'System.Windows.Forms.RadioButton'
	$buttonUserIsAMemberOf = New-Object 'System.Windows.Forms.Button'
	$buttonLoadADModule = New-Object 'System.Windows.Forms.Button'
	$folderbrowserdialog1 = New-Object 'System.Windows.Forms.FolderBrowserDialog'
	$InitialFormWindowState = New-Object 'System.Windows.Forms.FormWindowState'
	#endregion Generated Form Objects

	#----------------------------------------------
	# User Generated Script
	#----------------------------------------------
	# Set-ExecutionPolicy unrestricted
	
	
	$formLazyAdmin_Load= {
		$os = Get-CimInstance -ClassName Win32_OperatingSystem
		$folderbrowserdialog1.SelectedPath = "\\at-npf1-m001\"
		#$label1.Text= You are using: " + "$($os.Caption)" + "`n" + " OS_Version is: " + "$($os.Version)" + "`n"  + " Your Power Shell Version is: " +  $($PSVersionTable.PSVersion)
		
	}
	
	$buttonLoadADModule_Click={
		Import-Module ActiveDirectory	
	}
	
	$buttonShow_Click={Get-UserInfo}
	
	#region Control Helper Functions
	function Update-DataGridView
	{
		<#
		.SYNOPSIS
			This functions helps you load items into a DataGridView.
	
		.DESCRIPTION
			Use this function to dynamically load items into the DataGridView control.
	
		.PARAMETER  DataGridView
			The DataGridView control you want to add items to.
	
		.PARAMETER  Item
			The object or objects you wish to load into the DataGridView's items collection.
		
		.PARAMETER  DataMember
			Sets the name of the list or table in the data source for which the DataGridView is displaying data.
	
		.PARAMETER AutoSizeColumns
		    Resizes DataGridView control's columns after loading the items.
		#>
		Param (
			[ValidateNotNull()]
			[Parameter(Mandatory=$true)]
			[System.Windows.Forms.DataGridView]$DataGridView,
			[ValidateNotNull()]
			[Parameter(Mandatory=$true)]
			$Item,
		    [Parameter(Mandatory=$false)]
			[string]$DataMember,
			[System.Windows.Forms.DataGridViewAutoSizeColumnMode]$AutoSizeColumns = 'None'
		)
		$DataGridView.SuspendLayout()
		$DataGridView.DataMember = $DataMember
		
		if ($Item -is [System.Data.DataSet] -and $Item.Tables.Count -gt 0)
		{
			$DataGridView.DataSource = $Item.Tables[0]
		}
		elseif ($Item -is [System.ComponentModel.IListSource]`
		-or $Item -is [System.ComponentModel.IBindingList] -or $Item -is [System.ComponentModel.IBindingListView] )
		{
			$DataGridView.DataSource = $Item
		}
		else
		{
			$array = New-Object System.Collections.ArrayList
					
			if ($Item -is [System.Collections.IList])
			{
				$array.AddRange($Item)
			}
			else
			{
				$array.Add($Item)
			}
			$DataGridView.DataSource = $array
		}
		
		if ($AutoSizeColumns -ne 'None')
		{
			$DataGridView.AutoResizeColumns($AutoSizeColumns)
		}
		
		$DataGridView.ResumeLayout()
	}
	
	function ConvertTo-DataTable
	{
		<#
			.SYNOPSIS
				Converts objects into a DataTable.
		
			.DESCRIPTION
				Converts objects into a DataTable, which are used for DataBinding.
		
			.PARAMETER  InputObject
				The input to convert into a DataTable.
		
			.PARAMETER  Table
				The DataTable you wish to load the input into.
		
			.PARAMETER RetainColumns
				This switch tells the function to keep the DataTable's existing columns.
			
			.PARAMETER FilterWMIProperties
				This switch removes WMI properties that start with an underline.
		
			.EXAMPLE
				$DataTable = ConvertTo-DataTable -InputObject (Get-Process)
		#>
		[OutputType([System.Data.DataTable])]
		param(
		[ValidateNotNull()]
		$InputObject, 
		[ValidateNotNull()]
		[System.Data.DataTable]$Table,
		[switch]$RetainColumns,
		[switch]$FilterWMIProperties)
		
		if($null -eq $Table)
		{
			$Table = New-Object System.Data.DataTable
		}
		
		if ($InputObject -is [System.Data.DataTable])
		{
			$Table = $InputObject
		}
		elseif ($InputObject -is [System.Data.DataSet] -and $InputObject.Tables.Count -gt 0)
		{
			$Table = $InputObject.Tables[0]
		}
		else
		{
			if (-not $RetainColumns -or $Table.Columns.Count -eq 0)
			{
				#Clear out the Table Contents
				$Table.Clear()
				
				if ($null -eq $InputObject) { return } #Empty Data
				
				$object = $null
				#find the first non null value
				foreach ($item in $InputObject)
				{
					if ($null -ne $item)
					{
						$object = $item
						break
					}
				}
				
				if ($null -eq $object) { return } #All null then empty
				
				#Get all the properties in order to create the columns
				foreach ($prop in $object.PSObject.Get_Properties())
				{
					if (-not $FilterWMIProperties -or -not $prop.Name.StartsWith('__')) #filter out WMI properties
					{
						#Get the type from the Definition string
						$type = $null
						
						if ($null -ne $prop.Value)
						{
							try { $type = $prop.Value.GetType() }
							catch { Out-Null }
						}
						
						if ($null -ne $type) # -and [System.Type]::GetTypeCode($type) -ne 'Object')
						{
							[void]$table.Columns.Add($prop.Name, $type)
						}
						else #Type info not found
						{
							[void]$table.Columns.Add($prop.Name)
						}
					}
				}
				
				if ($object -is [System.Data.DataRow])
				{
					foreach ($item in $InputObject)
					{
						$Table.Rows.Add($item)
					}
					return @( ,$Table)
				}
			}
			else
			{
				$Table.Rows.Clear()
			}
			
			foreach ($item in $InputObject)
			{
				$row = $table.NewRow()
				
				if ($item)
				{
					foreach ($prop in $item.PSObject.Get_Properties())
					{
						if ($table.Columns.Contains($prop.Name))
						{
							$row.Item($prop.Name) = $prop.Value
						}
					}
				}
				[void]$table.Rows.Add($row)
			}
		}
		
		return @(,$Table)	
	}
	
	function Update-ListViewColumnSort
	{
	<#
		.SYNOPSIS
			Sort the ListView's item using the specified column.
		
		.DESCRIPTION
			Sort the ListView's item using the specified column.
			This function uses Add-Type to define a class that sort the items.
			The ListView's Tag property is used to keep track of the sorting.
		
		.PARAMETER ListView
			The ListView control to sort.
		
		.PARAMETER ColumnIndex
			The index of the column to use for sorting.
		
		.PARAMETER SortOrder
			The direction to sort the items. If not specified or set to None, it will toggle.
		
		.EXAMPLE
			Update-ListViewColumnSort -ListView $listview1 -ColumnIndex 0
		
		.NOTES
			Additional information about the function.
	#>
		
		param
		(
			[Parameter(Mandatory = $true)]
			[ValidateNotNull()]
			[System.Windows.Forms.ListView]
			$ListView,
			[Parameter(Mandatory = $true)]
			[int]
			$ColumnIndex,
			[System.Windows.Forms.SortOrder]
			$SortOrder = 'None'
		)
		
		if (($ListView.Items.Count -eq 0) -or ($ColumnIndex -lt 0) -or ($ColumnIndex -ge $ListView.Columns.Count))
		{
			return;
		}
		
		#region Define ListViewItemComparer
		try
		{
			[ListViewItemComparer] | Out-Null
		}
		catch
		{
			Add-Type -ReferencedAssemblies ('System.Windows.Forms') -TypeDefinition  @" 
	using System;
	using System.Windows.Forms;
	using System.Collections;
	public class ListViewItemComparer : IComparer
	{
	    public int column;
	    public SortOrder sortOrder;
	    public ListViewItemComparer()
	    {
	        column = 0;
			sortOrder = SortOrder.Ascending;
	    }
	    public ListViewItemComparer(int column, SortOrder sort)
	    {
	        this.column = column;
			sortOrder = sort;
	    }
	    public int Compare(object x, object y)
	    {
			if(column >= ((ListViewItem)x).SubItems.Count)
				return  sortOrder == SortOrder.Ascending ? -1 : 1;
		
			if(column >= ((ListViewItem)y).SubItems.Count)
				return sortOrder == SortOrder.Ascending ? 1 : -1;
		
			if(sortOrder == SortOrder.Ascending)
	        	return String.Compare(((ListViewItem)x).SubItems[column].Text, ((ListViewItem)y).SubItems[column].Text);
			else
				return String.Compare(((ListViewItem)y).SubItems[column].Text, ((ListViewItem)x).SubItems[column].Text);
	    }
	}
"@ | Out-Null
		}
		#endregion
		
		if ($ListView.Tag -is [ListViewItemComparer])
		{
			#Toggle the Sort Order
			if ($SortOrder -eq [System.Windows.Forms.SortOrder]::None)
			{
				if ($ListView.Tag.column -eq $ColumnIndex -and $ListView.Tag.sortOrder -eq 'Ascending')
				{
					$ListView.Tag.sortOrder = 'Descending'
				}
				else
				{
					$ListView.Tag.sortOrder = 'Ascending'
				}
			}
			else
			{
				$ListView.Tag.sortOrder = $SortOrder
			}
			
			$ListView.Tag.column = $ColumnIndex
			$ListView.Sort() #Sort the items
		}
		else
		{
			if ($SortOrder -eq [System.Windows.Forms.SortOrder]::None)
			{
				$SortOrder = [System.Windows.Forms.SortOrder]::Ascending
			}
			
			#Set to Tag because for some reason in PowerShell ListViewItemSorter prop returns null
			$ListView.Tag = New-Object ListViewItemComparer ($ColumnIndex, $SortOrder)
			$ListView.ListViewItemSorter = $ListView.Tag #Automatically sorts
		}
	}
	
	
	function Add-ListViewItem
	{
	<#
		.SYNOPSIS
			Adds the item(s) to the ListView and stores the object in the ListViewItem's Tag property.
	
		.DESCRIPTION
			Adds the item(s) to the ListView and stores the object in the ListViewItem's Tag property.
	
		.PARAMETER ListView
			The ListView control to add the items to.
	
		.PARAMETER Items
			The object or objects you wish to load into the ListView's Items collection.
			
		.PARAMETER  ImageIndex
			The index of a predefined image in the ListView's ImageList.
		
		.PARAMETER  SubItems
			List of strings to add as Subitems.
		
		.PARAMETER Group
			The group to place the item(s) in.
		
		.PARAMETER Clear
			This switch clears the ListView's Items before adding the new item(s).
		
		.EXAMPLE
			Add-ListViewItem -ListView $listview1 -Items "Test" -Group $listview1.Groups[0] -ImageIndex 0 -SubItems "Installed"
	#>
		
		Param( 
		[ValidateNotNull()]
		[Parameter(Mandatory=$true)]
		[System.Windows.Forms.ListView]$ListView,
		[ValidateNotNull()]
		[Parameter(Mandatory=$true)]
		$Items,
		[int]$ImageIndex = -1,
		[string[]]$SubItems,
		$Group,
		[switch]$Clear)
		
		if($Clear)
		{
			$ListView.Items.Clear();
	    }
	    
	    $lvGroup = $null
	    if ($Group -is [System.Windows.Forms.ListViewGroup])
	    {
	        $lvGroup = $Group
	    }
	    elseif ($Group -is [string])
	    {
	        #$lvGroup = $ListView.Group[$Group] # Case sensitive
	        foreach ($groupItem in $ListView.Groups)
	        {
	            if ($groupItem.Name -eq $Group)
	            {
	                $lvGroup = $groupItem
	                break
	            }
	        }
	        
	        if ($null -eq $lvGroup)
	        {
	            $lvGroup = $ListView.Groups.Add($Group, $Group)
	        }
	    }
	    
		if($Items -is [Array])
		{
			$ListView.BeginUpdate()
			foreach ($item in $Items)
			{		
				$listitem  = $ListView.Items.Add($item.ToString(), $ImageIndex)
				#Store the object in the Tag
				$listitem.Tag = $item
				
				if($null -ne $SubItems)
				{
					$listitem.SubItems.AddRange($SubItems)
				}
				
				if($null -ne $lvGroup)
				{
					$listitem.Group = $lvGroup
				}
			}
			$ListView.EndUpdate()
		}
		else
		{
			#Add a new item to the ListView
			$listitem  = $ListView.Items.Add($Items.ToString(), $ImageIndex)
			#Store the object in the Tag
			$listitem.Tag = $Items
			
			if($null -ne $SubItems)
			{
				$listitem.SubItems.AddRange($SubItems)
			}
			
			if($null -ne $lvGroup)
			{
				$listitem.Group = $lvGroup
			}
		}
	}
	
	#endregion
	
	$datagridview1_CellContentClick=[System.Windows.Forms.DataGridViewCellEventHandler]{
	#Event Argument: $_ = [System.Windows.Forms.DataGridViewCellEventArgs]
		#TODO: Place custom script here
		
	}
	
	function Get-UserInfo
	{
		
		$array = New-Object System.Collections.ArrayList
		
		if ($radiobuttonAll.Checked -eq $true)
		{
			$Script:procInfo = Get-ADUser -Filter * | Select Name, SamAccountName | sort -Property Name
			}
		
		if ($radiobuttonEnabled.Checked -eq $true) 
		{
			
			$Script:procInfo = Get-ADUser -Filter * | Where-Object { $_.enabled -eq $true } | select Name, SamAccountName | sort -Property Name
				
			# i may not need this
			$Path = "c:\temp\ADusers.csv"
			if (Test-Path $Path) 
			{ 
				Remove-Item $Path -Force 
			}
			Get-ADUser -Filter * | Where-Object { $_.enabled -eq $true } | select Name, SamAccountName | sort -Property Name| export-csv "c:\temp\ADusers.csv"
			# i may not need this
		}
		
		if ($radiobuttonDisabled.Checked -eq $true)
		{ $Script:procInfo = Search-ADAccount -AccountDisabled -UsersOnly | Select Name, SamAccountName | sort -Property Name }
		
		if ($radiobuttonLockedOut.Checked -eq $true)
		{ $Script:procInfo = Search-ADAccount –LockedOut | Select Name, SamAccountName | sort -Property Name	}
		
		if ($radiobuttonPasswordExpired.Checked -eq $true)
		{ $Script:procInfo = Search-ADAccount -PasswordExpired | Select Name, SamAccountName | sort -Property Name }
		
		if ($radiobuttonPasswordNeverExpire.Checked -eq $true)
		{ $Script:procInfo = Search-ADAccount -PasswordNeverExpires | Select Name, SamAccountName | sort -Property Name }
		
			
		if ($radiobuttonInactiveForTheLastDa.Checked -eq $true)
		{ $TS = $numericupdown2.Text + '.00:00:00'
			$Script:procInfo = Search-ADAccount -UsersOnly -AccountInactive -TimeSpan $TS | Select Name, SamAccountName | sort -Property Name }
		
		$labelCount.Text = $procInfo.count
		$array.AddRange($procInfo)
		$DGV.DataSource = $array
	}
	
	function Get-ComputerInfo
	{
		
		$array = New-Object System.Collections.ArrayList
		
		if ($radiobutton1.Checked -eq $true) {$Script:procInfo = Get-ADComputer -Filter * | Select Name | sort -Property Name}
		
			
		if ($radiobuttonNameBeginWith.Checked -eq $true)
		   	{$Filter = "Name -like " + '"' + $textbox1.Text + "*" + '"'
			$Script:procInfo = Get-ADComputer -Filter $Filter | Select Name | sort -Property Name	}
		
		if ($radiobuttonNameEndWith.Checked -eq $true)
			{$Filter = "Name -like " + '"' + "*" + $textbox1.Text +  '"'
			$Script:procInfo = Get-ADComputer -Filter $Filter | Select Name | sort -Property Name}
		
		if ($radiobuttonNameInclude.Checked -eq $true)
			{$Filter = "Name -like " + '"*' + $textbox1.Text + '*"'
		    $Script:procInfo = Get-ADComputer -Filter $Filter | Select Name | sort -Property Name}
		
		
		if ($radiobuttonDescriptionIncludeAW.Checked -eq $true)
			{$Filter = "Description -like " + '"*' + $textbox1.Text + '*"'
			$Script:procInfo = @(Get-ADComputer -Filter $Filter | Select Name | sort Name)}
			
		if ($radiobutton2.Checked -eq $true)
			{$TS = $numericupdown3.Text + '.00:00:00'
			$Script:procInfo = Search-ADAccount -ComputersOnly -AccountInactive -TimeSpan $TS | Select Name | sort -Property Name}
		
		try
		{ $array.AddRange($procInfo) }
		catch { $_.Exception.Message
				$ErrorMessage = $_.Exception.Message
				$textbox5.Text = $ErrorMessage
				continue
			}
		$DGV.DataSource = $array
		$labelCount.Text = $procInfo.count
	}
	
	$buttonUserIsAMemberOf_Click={
		$array = New-Object System.Collections.ArrayList
		$Script:procInfo = Get-ADPrincipalGroupMembership $textbox2.Text | select name
		$array.AddRange($procInfo)
		$DGV2.DataSource = $array
		$Labelcount2.Text= $procInfo.count
	}
	
	$buttonComputers_Click={Get-ComputerInfo}
	
	
	
	$buttonUsersLockedOut_Click={
		#TODO: Place custom script here
		
	}
	
	
	
	$buttonOpenNotePad_Click={
		#TODO: Place custom script here
		
	}
	
	$buttonSelectFolder_Click={
		$folderbrowserdialog1.ShowDialog()
		if ($folderbrowserdialog1.SelectedPath -ne $null)
		{
			
			$textbox3.Text = $folderbrowserdialog1.SelectedPath
		}
		
	}
	
	$buttonGenerateFolderNTFSRe_Click = {
		$OutFile = $textbox6.Text
		$RootPath = $textbox3.Text
		
		$Row = 1
		$xl = New-Object -ComObject Excel.Application
		$xl.DisplayAlerts = $false
		
		$wb = $xl.WorkBooks.Add()
		
		$ws = $wb.WorkSheets.item(1)
		$ws.Name = "Folder Permissions"
		
		$xl.Visible = $true
		
		$separator = "\"
		
		$Header = @('Folder Path', 'Identity Reference', 'Rights')
		$i = 0
		while ($i -ne $Header.length)
		{
			$ws.Cells.Item($Row, 1 + $i).Font.ColorIndex = 10
			$ws.Cells.Item($Row, 1 + $i).Font.Bold = $true
			$ws.Cells.Item($Row, 1 + $i) = $Header[$i]
			
			$i++
		}
		$BT = 0 # bold thik font counter
		
		$ACLs = get-acl $RootPath | ForEach-Object { $_.Access }
		Foreach ($ACL in $ACLs)
			{
				$text = $ACL.IdentityReference.tostring()
				$parts = $text.split($separator)
				
				$FSR = $ACL.FileSystemRights.tostring()
				$Flag = 0 # 0 means its not correct and this is the deafault case
				
				if ($parts[1])
				{
					
					
					if ($ACL.FileSystemRights.tostring() -eq "FullControl")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'W' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'w' }
						$Flag = 1
					}
					
					if ($ACL.FileSystemRights.tostring() -eq "Modify, Synchronize")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'W' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'w' }
						$Flag = 1
					}
					
					if ($ACL.FileSystemRights.tostring() -eq "ReadAndExecute, Synchronize")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'R' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'r' }
						$Flag = 1
					}
					
					if ($ACL.FileSystemRights.tostring() -eq "Delete")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'Correct' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'Correct' }
						$Flag = 1
					}
				
					$Row += 1
					if ($BT % 2 -eq 0) { $ws.Cells.Item($Row, 1).Font.ColorIndex  = 46 }
					$ws.Cells.Item($Row, 1) = $RootPath
					if ($BT % 2 -eq 0) { $ws.Cells.Item($Row, 2).Font.ColorIndex = 46 }
					$ws.Cells.Item($Row, 2) = $parts[1]
					if ($BT % 2 -eq 0) { $ws.Cells.Item($Row, 3).Font.ColorIndex = 46}
					$ws.Cells.Item($Row, 3) = $FSR
					if ($FSR -eq 'Correct') { $ws.Cells.Item($Row, 3).Interior.ColorIndex = 4 }
					if ($Flag -eq 0) { $ws.Cells.Item($Row, 3).Interior.ColorIndex = 3}
					
				}
				else { }
		
		}
		#////
		
		$Folders = dir $RootPath -recurse | where { $_.psiscontainer -eq $true }
		foreach ($Folder in $Folders)
		{
			$BT += 1
			$ACLs = get-acl $Folder.fullname | ForEach-Object { $_.Access }
			
			Foreach ($ACL in $ACLs)
			{
				$text = $ACL.IdentityReference.tostring()
				$parts = $text.split($separator)
				
				$FSR = $ACL.FileSystemRights.tostring()
				$Flag = 0 # 0 means its not correct and this is the deafault case
				
				if ($parts[1])
				{
					
					
					if ($ACL.FileSystemRights.tostring() -eq "FullControl")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'W' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'w' }
						$Flag = 1
					}
					
					if ($ACL.FileSystemRights.tostring() -eq "Modify, Synchronize")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'W' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'w' }
						$Flag = 1
					}
					
					if ($ACL.FileSystemRights.tostring() -eq "ReadAndExecute, Synchronize")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'R' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'r' }
						$Flag = 1
					}
					
					if ($ACL.FileSystemRights.tostring() -eq "Delete")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'Correct' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'Correct' }
						$Flag = 1
					}
					$RootPath
					$Row += 1
					if ($BT % 2 -eq 0) { $ws.Cells.Item($Row, 1).Font.ColorIndex = 46 }
					$ws.Cells.Item($Row, 1) = $Folder.Fullname
					if ($BT % 2 -eq 0) { $ws.Cells.Item($Row, 2).Font.ColorIndex = 46 }
					$ws.Cells.Item($Row, 2) = $parts[1]
					if ($BT % 2 -eq 0) { $ws.Cells.Item($Row, 3).Font.ColorIndex = 46 }
					$ws.Cells.Item($Row, 3) = $FSR
					if ($FSR -eq 'Correct') { $ws.Cells.Item($Row, 3).Interior.ColorIndex = 4 }
					if ($Flag -eq 0) { $ws.Cells.Item($Row, 3).Interior.ColorIndex = 3 }
					
				}
				else { }
			}
		}
		#////
		$objRange = $ws.UsedRange
		[void]$objRange.EntireColumn.Autofit()
		$wb.SaveAs($OutFile)
		$xl.Quit()
	}
	
	
	$buttonAbout_Click = {
		# add the required .NET assembly
		Add-Type -AssemblyName System.Windows.Forms
		#$popup_output = '"I choose a lazy person to do a hard job. Because a lazy person will find an easy way to do it." ― Bill Gates.'
		$popup_output = 'This Power Shell App is made by Jaber Al-Ani'
		
		$result = [System.Windows.Forms.MessageBox]::Show($popup_output)
	}
	
	$labelNoteOutPutIsFoundOnC_Click={
		#TODO: Place custom script here
		
	}
	
	$buttonSendAMessage_Click={
		if ($textbox2.Text)
		{
		$name =  $textbox2.Text
		$msg = $textbox4.Text
		Invoke-WmiMethod -Path Win32_Process -Name Create -ArgumentList "msg * $msg" -ComputerName $name
		}
		else
		{
			$textbox5.Text = "Choose a Device to send to!"
			$textbox5.Refresh()
		}
	}
	
	$buttonPingIt_Click={
		if ($textbox2.Text)
		{
			try
			{
				$textbox5.Visible = $true
				$textbox5.Text = Test-Connection $textbox2.Text | out-string
				$textbox5.Refresh()
				$textbox5.Text += Test-Connection $textbox2.Text -delay 1 | out-string
			}
			catch{ $_.Exception.Message
				$ErrorMessage = $_.Exception.Message
				$textbox5.Text = $ErrorMessage
				break}
		
		}
		else
		{
			$textbox5.Text = "Choose a Device to ping first!"
			$textbox5.Refresh()
		}
	}
	
	$buttonShutDownRestart_Click={
		#TODO: Place custom script here
		shutdown -i
	}
	
	$buttonTerminateARunningPro_Click={
		# Gathering processes
		if ($textbox2.Text)
		{
		Try
		{
				$Processes = Get-WmiObject Win32_Process -ComputerName $textbox2.Text | Out-GridView -PassThru -Title "Select processes"
			}
		Catch
		{
				$ErrorMessage = $_.Exception.Message
				$textbox5.Text = $ErrorMessage
			Break
		}
		
		If ($Processes)
		{
				
			Try
			{
			(Get-WmiObject Win32_Process -ComputerName $textbox2.Text | ?{ $_.ProcessName -match $Processes.Name }).Terminate()
				}
				catch [exception] { $ErrorMessage = $_.Exception.Message
	          $textbox5= $ErrorMessage}
				
			}
			Else
			{
				$textbox5.Text = "Processes have not been selected"
			}
		}
		Else
		{
			$textbox5.Text = "Select a Device first!"
		}
	}
	
	$buttonTerminateProcess_Click={
		#TODO: Place custom script here
					
		
		
			$buttonTerminateProcess.Enabled= $false
		
	}
	
	$buttonSaveReportTo_Click={
		
		$SaveFileDialog = New-Object System.Windows.Forms.SaveFileDialog
		$SaveFileDialog.initialDirectory = $initialDirectory
		$SaveFileDialog.filter = ".xlsx| .xlsx"
		$SaveFileDialog.ShowDialog() | Out-Null
		$textbox6.Text= $SaveFileDialog.FileName
	}
	
	
	
	
	
	$buttonNotePad_Click={
		#TODO: Place custom script here
		Start-Process 'C:\windows\system32\notepad.exe'
	}
	
	$buttonRecursiveGroupMember_Click={
		
		$CurrentUser = $textbox2.Text
		$CurrentUserGroups = (GET-ADUSER –Identity $CurrentUser –Properties MemberOf | Select-Object MemberOf).MemberOf
	
			
		foreach ($group in $CurrentUserGroups)
		{
			$strGroup = $group.split(',')[0]
			
			$strGroup = $strGroup.split('=')[1]
			
			GetGroups -strGroup $strGroup
		}
	}
	
	$buttonPCEventLog_Click={
		if ($textbox2.Text)
		{
			Try
			{
				Get-EventLog -ComputerName $textbox2.Text -LogName System -Newest $numericupdown1.Text | Where-Object { $_.EntryType -like 'Error' -or $_.EntryType -like 'Warning' } | Sort-Object Source | Out-GridView -PassThru -Title "Select event"
			}
			catch { }
		}
		
	}
	
	
	Function Test-ADGroupMember
	{
		
		Param ($User, $Group)
		
		Trap { Return "error" }
		
		If (Get-ADUser -Filter "memberOf -RecursiveMatch '$((Get-ADGroup $Group).DistinguishedName)'" -SearchBase $((Get-ADUser $User).DistinguishedName))
		{$true}
		
		Else { $false }
		
	}
	$buttonGenerateUserNTFSRepo_Click = {
		$OutFile = $textbox6.Text
		
		$Row = 1
		$xl = New-Object -ComObject Excel.Application
		$xl.DisplayAlerts = $false
		
		$wb = $xl.WorkBooks.Add()
		
		$ws = $wb.WorkSheets.item(1)
		$ws.Name = "Folder Permissions"
		
		$xl.Visible = $true
		
		#To create an arraz of users and make them a header
		$x = @(Get-ADUser -Filter * | Where-Object { $_.enabled -eq $true } | select Name, sAMAccountName, Title | sort -Property sAMAccountName)
		
		$i = 0
		while ($i -ne $x.length)
		{
			$ws.Cells.Item($Row, 2 + $i).Font.ColorIndex = 10
			$ws.Cells.Item($Row, 2 + $i).Font.Bold = $true
			$ws.Cells.Item($Row, 2 + $i) = $x[$i].Name
			
			#$x[$i].Title = 2 + $i
			#$ws.Cells.Item(2, 2 + $i) = $x[$i].Title
			
			$i++
		}
		##
		
		$separator = "\"
		$OutFile = $textbox6.Text
		
		
		$RootPath = $textbox3.Text
		
			$Row += 1
			$ws.Cells.Item($Row, 1) = $RootPath
			$ACLs = get-acl $RootPath | ForEach-Object { $_.Access }
			Foreach ($ACL in $ACLs)
			{
				$text = $ACL.IdentityReference.tostring()
				$parts = $text.split($separator)
				$Flag = 0 # 0 means its not correct and this is the deafault case
				
				if ($parts[1])
				{
					
					$FSR = $ACL.FileSystemRights.tostring()
					
					$Group = $parts[1]
					
					if ($ACL.FileSystemRights.tostring() -eq "ReadAndExecute, Synchronize")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'R' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'r' }
					$Flag = 1
					}
					
					if ($ACL.FileSystemRights.tostring() -eq "FullControl")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'W' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'w' }
					$Flag = 1
					}
					
					if ($ACL.FileSystemRights.tostring() -eq "Modify, Synchronize")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'W' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'w' }
					$Flag = 1
					}
					
					
					if ($ACL.FileSystemRights.tostring() -eq "Delete")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'Correct' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'Correct' }
					$Flag = 1
					}
					
					$i = 0
					while ($i -ne $x.length)
					{
						
						$User = $x[$i].SamAccountName
						
						$Result = Test-ADGroupMember $User $Group
						
						if ($Result -eq $true)
						{
							if ($FSR -eq "Correct") { $ws.Cells.Item($Row, 2 + $i).Interior.ColorIndex = 4 }
							if ($Flag -eq 0) { $ws.Cells.Item($Row, 2 + $i).Interior.ColorIndex = 3 }
							$GoLiveDate = $ws.Cells.Item($Row, 2 + $i).value()
							if ($GoLiveDate -eq "W" -Or $GoLiveDate -eq "w" ) { }
							else
							{
								$ws.Cells.Item($Row, 2 + $i) = $FSR
							}
						}
						if ($Result -eq $false) { }
						
						if ($Result -eq "error") { }
						
						$i++
						
					}
					
					
				}
				
				
			}
			
		
		################################################
		$Folders = dir $RootPath -recurse | where { $_.psiscontainer -eq $true }
		foreach ($Folder in $Folders)
		{
			$Row += 1
			$ws.Cells.Item($Row, 1) = $Folder.fullname
			$ACLs = get-acl $Folder.fullname | ForEach-Object { $_.Access }
			Foreach ($ACL in $ACLs)
			{
				$text = $ACL.IdentityReference.tostring()
				$parts = $text.split($separator)
				$Flag = 0 # 0 means its not correct and this is the deafault case
				
				if ($parts[1])
				{
					
					$FSR = $ACL.FileSystemRights.tostring()
					
					$Group = $parts[1]
					
					if ($ACL.FileSystemRights.tostring() -eq "ReadAndExecute, Synchronize")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'R' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'r' }
						$Flag = 1
					}
					
					if ($ACL.FileSystemRights.tostring() -eq "FullControl")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'W' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'w' }
						$Flag = 1
					}
					
					if ($ACL.FileSystemRights.tostring() -eq "Modify, Synchronize")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'W' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'w' }
						$Flag = 1
					}
					
					
					if ($ACL.FileSystemRights.tostring() -eq "Delete")
					{
						if ($ACL.IsInherited.tostring() -eq "True") { $FSR = 'Correct' }
						if ($ACL.IsInherited.tostring() -eq "False") { $FSR = 'Correct' }
						$Flag = 1
					}
					
					$i = 0
					while ($i -ne $x.length)
					{
						
						$User = $x[$i].SamAccountName
						
						$Result = Test-ADGroupMember $User $Group
						
						if ($Result -eq $true)
						{
							if ($FSR -eq "Correct") { $ws.Cells.Item($Row, 2 + $i).Interior.ColorIndex = 4 }
							if ($Flag -eq 0) { $ws.Cells.Item($Row, 2 + $i).Interior.ColorIndex = 3 }
							$GoLiveDate = $ws.Cells.Item($Row, 2 + $i).value()
							if ($GoLiveDate -eq "W" -Or $GoLiveDate -eq "w") { }
							else
							{
								$ws.Cells.Item($Row, 2 + $i) = $FSR
							}
						}
						if ($Result -eq $false) { }
						
						if ($Result -eq "error") { }
						
						$i++
						
					}
					
					
				}
				
				
			}
			
		}
		################################################
		
		$objRange = $ws.UsedRange
		[void]$objRange.EntireColumn.Autofit()
		$wb.SaveAs($OutFile)
		$xl.Quit()
		
	}
	$button1_Click={
		#TODO: Place custom script here
		$array = New-Object System.Collections.ArrayList
		
		if ($radiobutton6.Checked -eq $true)
		{
			$Script:procInfo = Get-ADGroup -Filter * | Select SamAccountName | sort -Property Name
		}
		$array.AddRange($procInfo)
		$DGV.DataSource = $array
		$labelCount.Text = $procInfo.count
	}
	
	$buttonUserIsMemberOfNested_Click={
		#TODO: Place custom script here
		$CurrentUser = $textbox2.Text
		
		$CurrentUserGroups = (GET-ADUSER –Identity $CurrentUser –Properties MemberOf | Select-Object MemberOf).MemberOf
		
		foreach ($group in $CurrentUserGroups)
		{
			$strGroup = $group.split(',')[0]
			$strGroup = $strGroup.split('=')[1]
			
			GetGroups -strGroup $strGroup
		}
		
	}
	
	function GetGroups
	{
		param ($strGroup)
		
		$CurrentGroupGroups = (GET-ADGROUP –Identity $strGroup –Properties MemberOf | Select-Object MemberOf).MemberOf
		foreach ($Memgroup in $CurrentGroupGroups)
		{
			$strMemGroup = $Memgroup.split(',')[0]
			
			$strMemGroup = $strMemGroup.split('=')[1]
			
			GetGroups -strGroup $strMemGroup
		}
	}
	
	$UsersinthisGroup_Click={
		$GroupName = $textbox2.Text
		$array = New-Object System.Collections.ArrayList
		$Script:procInfo = Get-ADNestedGroupMembers $GroupName | Select-Object Name
		$array.AddRange($procInfo)
		$DGV2.DataSource = $array
		$Labelcount2.Text = $procInfo.count
	}
	
	function Get-ADNestedGroupMembers
	{
		[cmdletbinding()]
		param ([String]$Group)
		
		$Members = Get-ADGroupMember -Identity $Group
		$members | % {
			if ($_.ObjectClass -eq "group")
			{
				Get-ADNestedGroupMembers -Group $_.distinguishedName
			}
			else
			{
				return $_
			}
		}
	}
	$DGV_CellMouseClick = [System.Windows.Forms.DataGridViewCellMouseEventHandler]{
		
		$textbox2.Text = ""
		if ($DGV.CurrentRow.Cells[1].Value)
		{
			$textbox2.Text = $DGV.CurrentRow.Cells[1].Value
		}
		else { $textbox2.Text = $DGV.CurrentRow.Cells[0].Value }
	}
	
	$DGV2_CellMouseClick = [System.Windows.Forms.DataGridViewCellMouseEventHandler]{
		$textbox2.Text = ""
		$textbox2.Text = $DGV2.CurrentRow.Cells[0].Value
	}
	# --End User Generated Script--
	#----------------------------------------------
	#region Generated Events
	#----------------------------------------------
	
	$Form_StateCorrection_Load=
	{
		#Correct the initial state of the form to prevent the .Net maximized form issue
		$formLazyAdmin.WindowState = $InitialFormWindowState
	}
	
	$Form_Cleanup_FormClosed=
	{
		#Remove all event handlers from the controls
		try
		{
			$UsersinthisGroup.remove_Click($UsersinthisGroup_Click)
			$button1.remove_Click($button1_Click)
			$buttonNotePad.remove_Click($buttonNotePad_Click)
			$buttonPCEventLog.remove_Click($buttonPCEventLog_Click)
			$buttonShutDownRestart.remove_Click($buttonShutDownRestart_Click)
			$buttonPingIt.remove_Click($buttonPingIt_Click)
			$buttonTerminateARunningPro.remove_Click($buttonTerminateARunningPro_Click)
			$buttonSendAMessage.remove_Click($buttonSendAMessage_Click)
			$buttonAbout.remove_Click($buttonAbout_Click)
			$buttonGenerateUserNTFSRepo.remove_Click($buttonGenerateUserNTFSRepo_Click)
			$buttonSaveReportTo.remove_Click($buttonSaveReportTo_Click)
			$buttonGenerateFolderNTFSRe.remove_Click($buttonGenerateFolderNTFSRe_Click)
			$buttonSelectFolder.remove_Click($buttonSelectFolder_Click)
			$DGV.remove_CellMouseClick($DGV_CellMouseClick)
			$buttonComputers.remove_Click($buttonComputers_Click)
			$DGV2.remove_CellMouseClick($DGV2_CellMouseClick)
			$buttonShow.remove_Click($buttonShow_Click)
			$buttonUserIsAMemberOf.remove_Click($buttonUserIsAMemberOf_Click)
			$buttonLoadADModule.remove_Click($buttonLoadADModule_Click)
			$formLazyAdmin.remove_Load($formLazyAdmin_Load)
			$formLazyAdmin.remove_Load($Form_StateCorrection_Load)
			$formLazyAdmin.remove_FormClosed($Form_Cleanup_FormClosed)
		}
		catch { Out-Null <# Prevent PSScriptAnalyzer warning #> }
	}
	#endregion Generated Events

	#----------------------------------------------
	#region Generated Form Code
	#----------------------------------------------
	$formLazyAdmin.SuspendLayout()
	$groupbox5.SuspendLayout()
	$groupbox4.SuspendLayout()
	$numericupdown1.BeginInit()
	$groupbox3.SuspendLayout()
	$groupbox2.SuspendLayout()
	$numericupdown3.BeginInit()
	$groupbox1.SuspendLayout()
	$numericupdown2.BeginInit()
	#
	# formLazyAdmin
	#
	$formLazyAdmin.Controls.Add($Labelcount2)
	$formLazyAdmin.Controls.Add($UsersinthisGroup)
	$formLazyAdmin.Controls.Add($groupbox5)
	$formLazyAdmin.Controls.Add($labelCount)
	$formLazyAdmin.Controls.Add($buttonNotePad)
	$formLazyAdmin.Controls.Add($groupbox4)
	$formLazyAdmin.Controls.Add($buttonAbout)
	$formLazyAdmin.Controls.Add($groupbox3)
	$formLazyAdmin.Controls.Add($DGV)
	$formLazyAdmin.Controls.Add($groupbox2)
	$formLazyAdmin.Controls.Add($DGV2)
	$formLazyAdmin.Controls.Add($textbox2)
	$formLazyAdmin.Controls.Add($groupbox1)
	$formLazyAdmin.Controls.Add($buttonUserIsAMemberOf)
	$formLazyAdmin.Controls.Add($buttonLoadADModule)
	$formLazyAdmin.AutoScaleDimensions = '6, 13'
	$formLazyAdmin.AutoScaleMode = 'Font'
	$formLazyAdmin.ClientSize = '1903, 1053'
	#region Binary Data
	$formLazyAdmin.Icon = [System.Convert]::FromBase64String('
AAABAAEAFxAAAAEAIAAoBgAAFgAAACgAAAAXAAAAIAAAAAEAIAAAAAAAwAUAAMMOAADDDgAAAAAA
AAAAAAD/ze3//9Lz//vP9P/0zur/9Nnd//bd0//64ND//+LN///iy///4sv//uDP//jezf/74dD/
+uLO//jdyf/639H/99vb//LT4v/40PP/+M73//TK8//51O7/+Nzb/9Gczv+EUoj/onCw/8aa1f/x
yfL/+dXt//TQ3P//29v//d3Q//ndzP/5387/+uDQ//vh0f/43NH//t3a//3Z5f/50O//yZ3M/6Nz
rv+CU5L/hFSO//XM8f/z19f/oWi9/0YObf9IDIL/QgeB/08SgP+KTKr/zJPY//3N9//51+L/9t/X
//jj1P/539H/+9zT///Y4P/6ze7/zJbS/3M1j/9PDXf/Tg2A/0kMev9OFHP/wpTP//rb3v/Fktz/
bzuO/31IsP9NEoT/Swp+/1ALev9XEXb/i06e//XO/P/rz+P/79rZ//fb2//60Of/+sfz/3U/gv9T
F2//Tw50/1gWgP9tLpb/g0mo/4FLnv/1yPn/+NnW//rW5P/92en/89Dq//DK7v/Sn9j/jE6c/10U
e/9QC3r/ShR1/+7F///x0u//9M/v/8qR3P9XFnn/ThJ3/0kTbf+jcLT/+Mr5//fP6//61Ob//dfp
//ra3//64tD/+d3M//nfzv/949P//N7Z///W5f/6yPL/0JLg/1MRd/9KDH7/SRF4//XE///Iktf/
VxJ5/1INfP9pMIv/x5nb//bP7//4197//eDX//jezf/128v/+uDP//fgyv//5dH/+d7K//rfy//8
39D/+drR///d4f/40ef/98b8/1UVef9TC4P/WA2A/1kNfP9gE4L/dzaL//vQ9f/01dz/+NrV///l
2v/12sz/+uHR//7l1f/54ND/+uDQ//vgzP/84c3//+LN//7hzP/94s7/993N//ve2f/4z+7/97j/
/1oKi/9dBI//YQiN/5NDtP/6u////9rk//jhy//+487/99/J//rf0f/74dP/9N3N//ng0P/53tD/
/OHN//3izv//4s3//eDL//3izv/33c3/+NvW//rR8P/3uP//WgqL/1wDjv9hCI3/jz+w///B///9
2OL/+OHL//7jzv/64sz/+N3P//vh0//238//+N/P//3i1P/74Mz/++DM//vgzP/+4dL/+9zT//3a
3v/+1+3/8sH3/1ISdv9YEIj/WA2A/10RgP9eEYD/eTiN//fM8f/42eD/99nU//re0//639H/+eDQ
//rh0f/95NT/9NrK//zgz//74dD/+uDQ//XX0v//1uX//cv1/82P3f9VE3n/SAp8/00VfP/xwP//
xY/U/1gTev9QC3r/cDeS/+7A///30PD//t3k//fa0f/43s3//ePT//bcy//85c//+9fl//nV5f/0
0ev/99H1/8uY0f+LTZv/WxJ5/1EMe/9sNpf/68L//+7P7P/61fX/yI/a/1cWef9KDnP/UBp0/6Jv
s//Imsn/98/r//vV5//40uT/+9vg//bezP+/jNb/bTmM/2k0nP9KD4H/UhGF/08Kef9dF3z/iEub
/+7H9f/rz+P/8t3c//ba2v//1ez/y5jE/3M9gP9UGHD/TQxy/1YUfv9WF3//azGQ/4ROof/2yfr/
99jV/6lwxf9FDWz/RwuB/0UKhP9LDnz/dDaU/8yT2P/7y/X//dvm//jh2f/y3c7/+d/R//vc0//7
1Nz//tHy/8qU0P9WGHL/UQ95/0sKff9JDHr/SxFw/8aY0//73N//ypXH/4lXjf+kcrL/nHCr/8ef
yP/00Oj//trm//vX1//7287//+PS//jezf/74dH/++HR//vf1P/72tf/+9fj//fO7f/InMv/pXWw
/55vrv+FVY//8cjt//nd3f//0fH//M3u//jM8f/81vL/8tfb//jf1f/538///+LN///jzP/93sf/
/uDP//zi0f/33cz/+eHN//7jz//53tD/+Nzc//PU4//3z/L/+c/4//fN9v/51O7/9dnY/wAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAA=')
	#endregion
	$formLazyAdmin.Name = 'formLazyAdmin'
	$formLazyAdmin.Text = 'Lazy Admin'
	$formLazyAdmin.WindowState = 'Maximized'
	$formLazyAdmin.add_Load($formLazyAdmin_Load)
	#
	# Labelcount2
	#
	$Labelcount2.AutoSize = $True
	$Labelcount2.Location = '1237, 530'
	$Labelcount2.Name = 'Labelcount2'
	$Labelcount2.Size = '34, 13'
	$Labelcount2.TabIndex = 34
	$Labelcount2.Text = 'count'
	#
	# UsersinthisGroup
	#
	$UsersinthisGroup.Location = '563, 480'
	$UsersinthisGroup.Name = 'UsersinthisGroup'
	$UsersinthisGroup.Size = '232, 23'
	$UsersinthisGroup.TabIndex = 33
	$UsersinthisGroup.Text = 'Users in this Group > Nestedly'
	$UsersinthisGroup.UseVisualStyleBackColor = $True
	$UsersinthisGroup.add_Click($UsersinthisGroup_Click)
	#
	# groupbox5
	#
	$groupbox5.Controls.Add($button1)
	$groupbox5.Controls.Add($radiobutton6)
	$groupbox5.Location = '569, 77'
	$groupbox5.Name = 'groupbox5'
	$groupbox5.Size = '226, 391'
	$groupbox5.TabIndex = 32
	$groupbox5.TabStop = $False
	$groupbox5.Text = 'Groups'
	#
	# button1
	#
	$button1.Location = '16, 330'
	$button1.Name = 'button1'
	$button1.Size = '100, 54'
	$button1.TabIndex = 1
	$button1.Text = 'Show'
	$button1.UseVisualStyleBackColor = $True
	$button1.add_Click($button1_Click)
	#
	# radiobutton6
	#
	$radiobutton6.Location = '16, 28'
	$radiobutton6.Name = 'radiobutton6'
	$radiobutton6.Size = '104, 24'
	$radiobutton6.TabIndex = 0
	$radiobutton6.TabStop = $True
	$radiobutton6.Text = 'All'
	$radiobutton6.UseVisualStyleBackColor = $True
	#
	# labelCount
	#
	$labelCount.AutoSize = $True
	$labelCount.Location = '804, 526'
	$labelCount.Name = 'labelCount'
	$labelCount.Size = '35, 13'
	$labelCount.TabIndex = 31
	$labelCount.Text = 'Count'
	#
	# buttonNotePad
	#
	$buttonNotePad.Location = '1777, 1018'
	$buttonNotePad.Name = 'buttonNotePad'
	$buttonNotePad.Size = '96, 23'
	$buttonNotePad.TabIndex = 29
	$buttonNotePad.Text = 'Note pad'
	$buttonNotePad.UseVisualStyleBackColor = $True
	$buttonNotePad.add_Click($buttonNotePad_Click)
	#
	# groupbox4
	#
	$groupbox4.Controls.Add($buttonDCEventLog)
	$groupbox4.Controls.Add($radiobuttonNewestEntries)
	$groupbox4.Controls.Add($datetimepicker1)
	$groupbox4.Controls.Add($numericupdown1)
	$groupbox4.Controls.Add($buttonPCEventLog)
	$groupbox4.Controls.Add($labelWindowsAndPowershell)
	$groupbox4.Controls.Add($buttonAddAPrinter)
	$groupbox4.Controls.Add($buttonDisplayAttachedPrint)
	$groupbox4.Controls.Add($labelResult)
	$groupbox4.Controls.Add($buttonShutDownRestart)
	$groupbox4.Controls.Add($buttonPingIt)
	$groupbox4.Controls.Add($textbox5)
	$groupbox4.Controls.Add($buttonTerminateARunningPro)
	$groupbox4.Controls.Add($textbox4)
	$groupbox4.Controls.Add($buttonSendAMessage)
	$groupbox4.Location = '26, 579'
	$groupbox4.Name = 'groupbox4'
	$groupbox4.Size = '1179, 462'
	$groupbox4.TabIndex = 28
	$groupbox4.TabStop = $False
	$groupbox4.Text = 'Operations On Computers'
	#
	# buttonDCEventLog
	#
	$buttonDCEventLog.Location = '21, 320'
	$buttonDCEventLog.Name = 'buttonDCEventLog'
	$buttonDCEventLog.Size = '156, 23'
	$buttonDCEventLog.TabIndex = 36
	$buttonDCEventLog.Text = 'DC Event Log'
	$buttonDCEventLog.UseVisualStyleBackColor = $True
	#
	# radiobuttonNewestEntries
	#
	$radiobuttonNewestEntries.Location = '184, 281'
	$radiobuttonNewestEntries.Name = 'radiobuttonNewestEntries'
	$radiobuttonNewestEntries.Size = '104, 24'
	$radiobuttonNewestEntries.TabIndex = 35
	$radiobuttonNewestEntries.TabStop = $True
	$radiobuttonNewestEntries.Text = 'Newest Entries'
	$radiobuttonNewestEntries.UseVisualStyleBackColor = $True
	#
	# datetimepicker1
	#
	$datetimepicker1.Format = 'Short'
	$datetimepicker1.Location = '267, 320'
	$datetimepicker1.Name = 'datetimepicker1'
	$datetimepicker1.Size = '88, 20'
	$datetimepicker1.TabIndex = 34
	#
	# numericupdown1
	#
	$numericupdown1.Location = '294, 284'
	$numericupdown1.Maximum = 15000
	$numericupdown1.Name = 'numericupdown1'
	$numericupdown1.Size = '71, 20'
	$numericupdown1.TabIndex = 33
	$numericupdown1.Value = 100
	#
	# buttonPCEventLog
	#
	$buttonPCEventLog.Location = '21, 281'
	$buttonPCEventLog.Name = 'buttonPCEventLog'
	$buttonPCEventLog.Size = '156, 23'
	$buttonPCEventLog.TabIndex = 32
	$buttonPCEventLog.Text = 'PC Event Log'
	$buttonPCEventLog.UseVisualStyleBackColor = $True
	$buttonPCEventLog.add_Click($buttonPCEventLog_Click)
	#
	# labelWindowsAndPowershell
	#
	$labelWindowsAndPowershell.AutoSize = $True
	$labelWindowsAndPowershell.Location = '217, 35'
	$labelWindowsAndPowershell.Name = 'labelWindowsAndPowershell'
	$labelWindowsAndPowershell.Size = '163, 13'
	$labelWindowsAndPowershell.TabIndex = 24
	$labelWindowsAndPowershell.Text = 'Windows and Powershell version'
	#
	# buttonAddAPrinter
	#
	$buttonAddAPrinter.Location = '21, 204'
	$buttonAddAPrinter.Name = 'buttonAddAPrinter'
	$buttonAddAPrinter.Size = '156, 23'
	$buttonAddAPrinter.TabIndex = 31
	$buttonAddAPrinter.Text = 'Add a printer'
	$buttonAddAPrinter.UseVisualStyleBackColor = $True
	#
	# buttonDisplayAttachedPrint
	#
	$buttonDisplayAttachedPrint.Location = '21, 164'
	$buttonDisplayAttachedPrint.Name = 'buttonDisplayAttachedPrint'
	$buttonDisplayAttachedPrint.Size = '156, 23'
	$buttonDisplayAttachedPrint.TabIndex = 30
	$buttonDisplayAttachedPrint.Text = 'Display attached Printers'
	$buttonDisplayAttachedPrint.UseVisualStyleBackColor = $True
	#
	# labelResult
	#
	$labelResult.AutoSize = $True
	$labelResult.Location = '599, 16'
	$labelResult.Name = 'labelResult'
	$labelResult.Size = '37, 13'
	$labelResult.TabIndex = 29
	$labelResult.Text = 'Result'
	#
	# buttonShutDownRestart
	#
	$buttonShutDownRestart.Location = '21, 242'
	$buttonShutDownRestart.Name = 'buttonShutDownRestart'
	$buttonShutDownRestart.Size = '156, 23'
	$buttonShutDownRestart.TabIndex = 21
	$buttonShutDownRestart.Text = 'Shut Down | Restart'
	$buttonShutDownRestart.UseVisualStyleBackColor = $True
	$buttonShutDownRestart.add_Click($buttonShutDownRestart_Click)
	#
	# buttonPingIt
	#
	$buttonPingIt.Location = '21, 39'
	$buttonPingIt.Name = 'buttonPingIt'
	$buttonPingIt.Size = '156, 23'
	$buttonPingIt.TabIndex = 20
	$buttonPingIt.Text = 'Ping it'
	$buttonPingIt.UseVisualStyleBackColor = $True
	$buttonPingIt.add_Click($buttonPingIt_Click)
	#
	# textbox5
	#
	$textbox5.Location = '599, 35'
	$textbox5.Multiline = $True
	$textbox5.Name = 'textbox5'
	$textbox5.Size = '574, 245'
	$textbox5.TabIndex = 26
	#
	# buttonTerminateARunningPro
	#
	$buttonTerminateARunningPro.Location = '21, 120'
	$buttonTerminateARunningPro.Name = 'buttonTerminateARunningPro'
	$buttonTerminateARunningPro.Size = '156, 23'
	$buttonTerminateARunningPro.TabIndex = 22
	$buttonTerminateARunningPro.Text = 'Terminate a Running Process'
	$buttonTerminateARunningPro.UseVisualStyleBackColor = $True
	$buttonTerminateARunningPro.add_Click($buttonTerminateARunningPro_Click)
	#
	# textbox4
	#
	$textbox4.Location = '201, 82'
	$textbox4.Name = 'textbox4'
	$textbox4.Size = '317, 20'
	$textbox4.TabIndex = 25
	#
	# buttonSendAMessage
	#
	$buttonSendAMessage.Location = '21, 80'
	$buttonSendAMessage.Name = 'buttonSendAMessage'
	$buttonSendAMessage.Size = '156, 23'
	$buttonSendAMessage.TabIndex = 23
	$buttonSendAMessage.Text = 'Send a Message'
	$buttonSendAMessage.UseVisualStyleBackColor = $True
	$buttonSendAMessage.add_Click($buttonSendAMessage_Click)
	#
	# buttonAbout
	#
	$buttonAbout.Location = '1777, 985'
	$buttonAbout.Name = 'buttonAbout'
	$buttonAbout.Size = '96, 23'
	$buttonAbout.TabIndex = 19
	$buttonAbout.Text = 'About'
	$buttonAbout.UseVisualStyleBackColor = $True
	$buttonAbout.add_Click($buttonAbout_Click)
	#
	# groupbox3
	#
	$groupbox3.Controls.Add($buttonGenerateUserNTFSRepo)
	$groupbox3.Controls.Add($textbox6)
	$groupbox3.Controls.Add($buttonSaveReportTo)
	$groupbox3.Controls.Add($buttonGenerateFolderNTFSRe)
	$groupbox3.Controls.Add($textbox3)
	$groupbox3.Controls.Add($labelWriteOrBrowsTheRootF)
	$groupbox3.Controls.Add($buttonSelectFolder)
	$groupbox3.Location = '1301, 630'
	$groupbox3.Name = 'groupbox3'
	$groupbox3.Size = '416, 214'
	$groupbox3.TabIndex = 18
	$groupbox3.TabStop = $False
	$groupbox3.Text = 'NTFS Reports'
	#
	# buttonGenerateUserNTFSRepo
	#
	$buttonGenerateUserNTFSRepo.Location = '254, 154'
	$buttonGenerateUserNTFSRepo.Name = 'buttonGenerateUserNTFSRepo'
	$buttonGenerateUserNTFSRepo.Size = '146, 54'
	$buttonGenerateUserNTFSRepo.TabIndex = 24
	$buttonGenerateUserNTFSRepo.Text = 'Generate User NTFS Report'
	$buttonGenerateUserNTFSRepo.UseVisualStyleBackColor = $True
	$buttonGenerateUserNTFSRepo.add_Click($buttonGenerateUserNTFSRepo_Click)
	#
	# textbox6
	#
	$textbox6.Location = '142, 114'
	$textbox6.Name = 'textbox6'
	$textbox6.Size = '258, 20'
	$textbox6.TabIndex = 23
	#
	# buttonSaveReportTo
	#
	$buttonSaveReportTo.Location = '15, 108'
	$buttonSaveReportTo.Name = 'buttonSaveReportTo'
	$buttonSaveReportTo.Size = '111, 30'
	$buttonSaveReportTo.TabIndex = 22
	$buttonSaveReportTo.Text = 'Save Report to'
	$buttonSaveReportTo.UseVisualStyleBackColor = $True
	$buttonSaveReportTo.add_Click($buttonSaveReportTo_Click)
	#
	# buttonGenerateFolderNTFSRe
	#
	$buttonGenerateFolderNTFSRe.Location = '15, 154'
	$buttonGenerateFolderNTFSRe.Name = 'buttonGenerateFolderNTFSRe'
	$buttonGenerateFolderNTFSRe.Size = '143, 54'
	$buttonGenerateFolderNTFSRe.TabIndex = 20
	$buttonGenerateFolderNTFSRe.Text = 'Generate Folder NTFS Reports'
	$buttonGenerateFolderNTFSRe.UseVisualStyleBackColor = $True
	$buttonGenerateFolderNTFSRe.add_Click($buttonGenerateFolderNTFSRe_Click)
	#
	# textbox3
	#
	$textbox3.Location = '142, 64'
	$textbox3.Name = 'textbox3'
	$textbox3.Size = '258, 20'
	$textbox3.TabIndex = 19
	#
	# labelWriteOrBrowsTheRootF
	#
	$labelWriteOrBrowsTheRootF.AutoSize = $True
	$labelWriteOrBrowsTheRootF.Location = '15, 35'
	$labelWriteOrBrowsTheRootF.Name = 'labelWriteOrBrowsTheRootF'
	$labelWriteOrBrowsTheRootF.Size = '146, 13'
	$labelWriteOrBrowsTheRootF.TabIndex = 18
	$labelWriteOrBrowsTheRootF.Text = 'Write or brows the root Folder'
	#
	# buttonSelectFolder
	#
	$buttonSelectFolder.Location = '15, 59'
	$buttonSelectFolder.Name = 'buttonSelectFolder'
	$buttonSelectFolder.Size = '111, 29'
	$buttonSelectFolder.TabIndex = 17
	$buttonSelectFolder.Text = 'Select Folder'
	$buttonSelectFolder.UseVisualStyleBackColor = $True
	$buttonSelectFolder.add_Click($buttonSelectFolder_Click)
	#
	# DGV
	#
	$DGV.AutoSizeColumnsMode = 'AllCells'
	$DGV.AutoSizeRowsMode = 'AllCells'
	$DGV.ColumnHeadersHeightSizeMode = 'AutoSize'
	$DGV.Location = '804, 21'
	$DGV.Name = 'DGV'
	$DGV.Size = '370, 502'
	$DGV.TabIndex = 15
	$DGV.add_CellMouseClick($DGV_CellMouseClick)
	#
	# groupbox2
	#
	$groupbox2.Controls.Add($radiobutton2)
	$groupbox2.Controls.Add($numericupdown3)
	$groupbox2.Controls.Add($radiobuttonNameEndWith)
	$groupbox2.Controls.Add($radiobuttonNameInclude)
	$groupbox2.Controls.Add($radiobuttonDescriptionIncludeAW)
	$groupbox2.Controls.Add($radiobuttonNameBeginWith)
	$groupbox2.Controls.Add($radiobutton1)
	$groupbox2.Controls.Add($textbox1)
	$groupbox2.Controls.Add($buttonComputers)
	$groupbox2.Location = '286, 77'
	$groupbox2.Name = 'groupbox2'
	$groupbox2.Size = '261, 391'
	$groupbox2.TabIndex = 14
	$groupbox2.TabStop = $False
	$groupbox2.Text = 'Computers'
	#
	# radiobutton2
	#
	$radiobutton2.Location = '6, 187'
	$radiobutton2.Name = 'radiobutton2'
	$radiobutton2.Size = '162, 24'
	$radiobutton2.TabIndex = 18
	$radiobutton2.TabStop = $True
	$radiobutton2.Text = 'Inactive for the Last Days >'
	$radiobutton2.UseVisualStyleBackColor = $True
	#
	# numericupdown3
	#
	$numericupdown3.Location = '168, 187'
	$numericupdown3.Name = 'numericupdown3'
	$numericupdown3.Size = '60, 20'
	$numericupdown3.TabIndex = 19
	#
	# radiobuttonNameEndWith
	#
	$radiobuttonNameEndWith.Location = '6, 88'
	$radiobuttonNameEndWith.Name = 'radiobuttonNameEndWith'
	$radiobuttonNameEndWith.Size = '115, 24'
	$radiobuttonNameEndWith.TabIndex = 19
	$radiobuttonNameEndWith.TabStop = $True
	$radiobuttonNameEndWith.Text = 'Name End With >'
	$radiobuttonNameEndWith.UseVisualStyleBackColor = $True
	#
	# radiobuttonNameInclude
	#
	$radiobuttonNameInclude.Location = '6, 118'
	$radiobuttonNameInclude.Name = 'radiobuttonNameInclude'
	$radiobuttonNameInclude.Size = '115, 24'
	$radiobuttonNameInclude.TabIndex = 18
	$radiobuttonNameInclude.TabStop = $True
	$radiobuttonNameInclude.Text = 'Name Include >'
	$radiobuttonNameInclude.UseVisualStyleBackColor = $True
	#
	# radiobuttonDescriptionIncludeAW
	#
	$radiobuttonDescriptionIncludeAW.Location = '6, 148'
	$radiobuttonDescriptionIncludeAW.Name = 'radiobuttonDescriptionIncludeAW'
	$radiobuttonDescriptionIncludeAW.Size = '215, 24'
	$radiobuttonDescriptionIncludeAW.TabIndex = 17
	$radiobuttonDescriptionIncludeAW.TabStop = $True
	$radiobuttonDescriptionIncludeAW.Text = 'Description Include a Word >'
	$radiobuttonDescriptionIncludeAW.UseVisualStyleBackColor = $True
	#
	# radiobuttonNameBeginWith
	#
	$radiobuttonNameBeginWith.Location = '6, 58'
	$radiobuttonNameBeginWith.Name = 'radiobuttonNameBeginWith'
	$radiobuttonNameBeginWith.Size = '143, 24'
	$radiobuttonNameBeginWith.TabIndex = 1
	$radiobuttonNameBeginWith.TabStop = $True
	$radiobuttonNameBeginWith.Text = 'Name Begin With >'
	$radiobuttonNameBeginWith.UseVisualStyleBackColor = $True
	#
	# radiobutton1
	#
	$radiobutton1.Location = '6, 28'
	$radiobutton1.Name = 'radiobutton1'
	$radiobutton1.Size = '104, 24'
	$radiobutton1.TabIndex = 0
	$radiobutton1.TabStop = $True
	$radiobutton1.Text = 'All'
	$radiobutton1.UseVisualStyleBackColor = $True
	#
	# textbox1
	#
	$textbox1.Location = '127, 92'
	$textbox1.Name = 'textbox1'
	$textbox1.Size = '124, 20'
	$textbox1.TabIndex = 3
	#
	# buttonComputers
	#
	$buttonComputers.Location = '10, 331'
	$buttonComputers.Name = 'buttonComputers'
	$buttonComputers.Size = '100, 54'
	$buttonComputers.TabIndex = 7
	$buttonComputers.Text = 'Show'
	$buttonComputers.UseVisualStyleBackColor = $True
	$buttonComputers.add_Click($buttonComputers_Click)
	#
	# DGV2
	#
	$DGV2.AutoSizeColumnsMode = 'AllCells'
	$DGV2.AutoSizeRowsMode = 'AllCells'
	$DGV2.ColumnHeadersHeightSizeMode = 'AutoSize'
	$DGV2.Location = '1237, 18'
	$DGV2.Name = 'DGV2'
	$DGV2.Size = '389, 505'
	$DGV2.TabIndex = 13
	$DGV2.add_CellMouseClick($DGV2_CellMouseClick)
	#
	# textbox2
	#
	$textbox2.Location = '1031, 553'
	$textbox2.Name = 'textbox2'
	$textbox2.Size = '329, 20'
	$textbox2.TabIndex = 12
	#
	# groupbox1
	#
	$groupbox1.Controls.Add($radiobuttonEnabled)
	$groupbox1.Controls.Add($radiobutton5)
	$groupbox1.Controls.Add($radiobutton4)
	$groupbox1.Controls.Add($radiobutton3)
	$groupbox1.Controls.Add($numericupdown2)
	$groupbox1.Controls.Add($radiobuttonInactiveForTheLastDa)
	$groupbox1.Controls.Add($radiobuttonPasswordNeverExpire)
	$groupbox1.Controls.Add($radiobuttonPasswordExpired)
	$groupbox1.Controls.Add($buttonShow)
	$groupbox1.Controls.Add($radiobuttonAll)
	$groupbox1.Controls.Add($radiobuttonDisabled)
	$groupbox1.Controls.Add($radiobuttonLockedOut)
	$groupbox1.Location = '26, 73'
	$groupbox1.Name = 'groupbox1'
	$groupbox1.Size = '231, 401'
	$groupbox1.TabIndex = 11
	$groupbox1.TabStop = $False
	$groupbox1.Text = 'Users'
	#
	# radiobuttonEnabled
	#
	$radiobuttonEnabled.Location = '6, 73'
	$radiobuttonEnabled.Name = 'radiobuttonEnabled'
	$radiobuttonEnabled.Size = '104, 24'
	$radiobuttonEnabled.TabIndex = 21
	$radiobuttonEnabled.TabStop = $True
	$radiobuttonEnabled.Text = 'Enabled'
	$radiobuttonEnabled.UseVisualStyleBackColor = $True
	#
	# radiobutton5
	#
	$radiobutton5.Location = '6, 274'
	$radiobutton5.Name = 'radiobutton5'
	$radiobutton5.Size = '115, 24'
	$radiobutton5.TabIndex = 20
	$radiobutton5.TabStop = $True
	$radiobutton5.Text = 'Name End With >'
	$radiobutton5.UseVisualStyleBackColor = $True
	#
	# radiobutton4
	#
	$radiobutton4.Location = '6, 304'
	$radiobutton4.Name = 'radiobutton4'
	$radiobutton4.Size = '115, 24'
	$radiobutton4.TabIndex = 20
	$radiobutton4.TabStop = $True
	$radiobutton4.Text = 'Name Include >'
	$radiobutton4.UseVisualStyleBackColor = $True
	#
	# radiobutton3
	#
	$radiobutton3.Location = '6, 244'
	$radiobutton3.Name = 'radiobutton3'
	$radiobutton3.Size = '143, 24'
	$radiobutton3.TabIndex = 20
	$radiobutton3.TabStop = $True
	$radiobutton3.Text = 'Name Begin With >'
	$radiobutton3.UseVisualStyleBackColor = $True
	#
	# numericupdown2
	#
	$numericupdown2.Location = '164, 205'
	$numericupdown2.Name = 'numericupdown2'
	$numericupdown2.Size = '57, 20'
	$numericupdown2.TabIndex = 17
	#
	# radiobuttonInactiveForTheLastDa
	#
	$radiobuttonInactiveForTheLastDa.Location = '6, 201'
	$radiobuttonInactiveForTheLastDa.Name = 'radiobuttonInactiveForTheLastDa'
	$radiobuttonInactiveForTheLastDa.Size = '155, 24'
	$radiobuttonInactiveForTheLastDa.TabIndex = 16
	$radiobuttonInactiveForTheLastDa.TabStop = $True
	$radiobuttonInactiveForTheLastDa.Text = 'Inactive for the Last Days'
	$radiobuttonInactiveForTheLastDa.UseVisualStyleBackColor = $True
	#
	# radiobuttonPasswordNeverExpire
	#
	$radiobuttonPasswordNeverExpire.Location = '6, 141'
	$radiobuttonPasswordNeverExpire.Name = 'radiobuttonPasswordNeverExpire'
	$radiobuttonPasswordNeverExpire.Size = '143, 24'
	$radiobuttonPasswordNeverExpire.TabIndex = 13
	$radiobuttonPasswordNeverExpire.TabStop = $True
	$radiobuttonPasswordNeverExpire.Text = 'Password Never Expire'
	$radiobuttonPasswordNeverExpire.UseVisualStyleBackColor = $True
	#
	# radiobuttonPasswordExpired
	#
	$radiobuttonPasswordExpired.Location = '6, 171'
	$radiobuttonPasswordExpired.Name = 'radiobuttonPasswordExpired'
	$radiobuttonPasswordExpired.Size = '115, 24'
	$radiobuttonPasswordExpired.TabIndex = 12
	$radiobuttonPasswordExpired.TabStop = $True
	$radiobuttonPasswordExpired.Text = 'Password Expired'
	$radiobuttonPasswordExpired.UseVisualStyleBackColor = $True
	#
	# buttonShow
	#
	$buttonShow.Location = '10, 334'
	$buttonShow.Name = 'buttonShow'
	$buttonShow.Size = '100, 54'
	$buttonShow.TabIndex = 1
	$buttonShow.Text = 'Show'
	$buttonShow.UseVisualStyleBackColor = $True
	$buttonShow.add_Click($buttonShow_Click)
	#
	# radiobuttonAll
	#
	$radiobuttonAll.Location = '6, 19'
	$radiobuttonAll.Name = 'radiobuttonAll'
	$radiobuttonAll.Size = '104, 24'
	$radiobuttonAll.TabIndex = 10
	$radiobuttonAll.TabStop = $True
	$radiobuttonAll.Text = 'All'
	$radiobuttonAll.UseVisualStyleBackColor = $True
	#
	# radiobuttonDisabled
	#
	$radiobuttonDisabled.Location = '6, 43'
	$radiobuttonDisabled.Name = 'radiobuttonDisabled'
	$radiobuttonDisabled.Size = '104, 24'
	$radiobuttonDisabled.TabIndex = 8
	$radiobuttonDisabled.TabStop = $True
	$radiobuttonDisabled.Text = 'Disabled'
	$radiobuttonDisabled.UseVisualStyleBackColor = $True
	#
	# radiobuttonLockedOut
	#
	$radiobuttonLockedOut.Location = '6, 111'
	$radiobuttonLockedOut.Name = 'radiobuttonLockedOut'
	$radiobuttonLockedOut.Size = '104, 24'
	$radiobuttonLockedOut.TabIndex = 9
	$radiobuttonLockedOut.TabStop = $True
	$radiobuttonLockedOut.Text = 'Locked Out'
	$radiobuttonLockedOut.UseVisualStyleBackColor = $True
	#
	# buttonUserIsAMemberOf
	#
	$buttonUserIsAMemberOf.Location = '25, 480'
	$buttonUserIsAMemberOf.Name = 'buttonUserIsAMemberOf'
	$buttonUserIsAMemberOf.Size = '232, 23'
	$buttonUserIsAMemberOf.TabIndex = 5
	$buttonUserIsAMemberOf.Text = 'User is a Member of'
	$buttonUserIsAMemberOf.UseVisualStyleBackColor = $True
	$buttonUserIsAMemberOf.add_Click($buttonUserIsAMemberOf_Click)
	#
	# buttonLoadADModule
	#
	$buttonLoadADModule.Location = '26, 12'
	$buttonLoadADModule.Name = 'buttonLoadADModule'
	$buttonLoadADModule.Size = '205, 38'
	$buttonLoadADModule.TabIndex = 0
	$buttonLoadADModule.Text = 'Load AD Module'
	$buttonLoadADModule.UseVisualStyleBackColor = $True
	$buttonLoadADModule.add_Click($buttonLoadADModule_Click)
	#
	# folderbrowserdialog1
	#
	$numericupdown2.EndInit()
	$groupbox1.ResumeLayout()
	$numericupdown3.EndInit()
	$groupbox2.ResumeLayout()
	$groupbox3.ResumeLayout()
	$numericupdown1.EndInit()
	$groupbox4.ResumeLayout()
	$groupbox5.ResumeLayout()
	$formLazyAdmin.ResumeLayout()
	#endregion Generated Form Code

	#----------------------------------------------

	#Save the initial state of the form
	$InitialFormWindowState = $formLazyAdmin.WindowState
	#Init the OnLoad event to correct the initial state of the form
	$formLazyAdmin.add_Load($Form_StateCorrection_Load)
	#Clean up the control events
	$formLazyAdmin.add_FormClosed($Form_Cleanup_FormClosed)
	#Show the Form
	return $formLazyAdmin.ShowDialog()

} #End Function

#Call the form
Show-Main_psf | Out-Null
